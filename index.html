<!DOCTYPE html>
<html lang="no">
<head>
  <meta charset="UTF-8">
  <title>Daglig Sjekkliste - Varme Arbeider</title>
  <div class="dato-container">
  <label for="dato-input">üìÖ Dato for sjekkliste:</label>
  <input type="date" id="dato-input">
</div>


  <link rel="stylesheet" href="checklist_style.css">
  <style>
    section {
      background: rgba(255, 255, 255, 0.07);
      padding: 1.5rem;
      margin-bottom: 1.5rem;
      border-radius: 15px;
      backdrop-filter: blur(8px);
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
    }
    h2 {
      margin-bottom: 1rem;
    }
    ul.fagarbeidere {
      list-style: none;
      padding: 0;
    }
    ul.fagarbeidere li {
      background-color: rgba(0, 0, 0, 0.2);
      padding: 0.5rem 1rem;
      margin: 0.3rem 0;
      border-radius: 8px;
    }
    #image-wrapper {
      position: relative;
      max-width: 800px;
      margin: auto;
    }
    #byggBilde {
      width: 100%;
      border-radius: 12px;
    }
    .omr√•de {
      position: absolute;
      cursor: pointer;
    }
.omr√•de1 { background-color: rgba(255, 0, 0, 0.45); border: 2px solid #a30000; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 2px #000; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de1:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(255, 0, 0, 0.5); filter: brightness(1.2); }
.omr√•de1.selected { background-color: rgba(255, 0, 0, 0.85); outline: 3px solid white; }

.omr√•de2 { background-color: rgba(0, 100, 255, 0.45); border: 2px solid #0033a0; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 2px #000; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de2:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(0, 100, 255, 0.5); filter: brightness(1.2); }
.omr√•de2.selected { background-color: rgba(0, 100, 255, 0.85); outline: 3px solid white; }

.omr√•de3 { background-color: rgba(255, 200, 0, 0.45); border: 2px solid #c49700; display: flex; align-items: center; justify-content: center; color: black; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 1px #fff; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de3:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(255, 200, 0, 0.5); filter: brightness(1.2); }
.omr√•de3.selected { background-color: rgba(255, 200, 0, 0.85); outline: 3px solid white; }

.omr√•de4 { background-color: rgba(0, 200, 150, 0.45); border: 2px solid #007a66; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 2px #000; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de4:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(0, 200, 150, 0.5); filter: brightness(1.2); }
.omr√•de4.selected { background-color: rgba(0, 200, 150, 0.85); outline: 3px solid white; }

.omr√•de5 { background-color: rgba(138, 43, 226, 0.45); border: 2px solid #6a1e9a; display: flex; align-items: center; justify-content: center; color: white; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 2px #000; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de5:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(138, 43, 226, 0.5); filter: brightness(1.2); }
.omr√•de5.selected { background-color: rgba(138, 43, 226, 0.85); outline: 3px solid white; }

.omr√•de6 { background-color: rgba(255, 140, 0, 0.45); border: 2px solid #b36200; display: flex; align-items: center; justify-content: center; color: black; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 1px #fff; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de6:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(255, 140, 0, 0.5); filter: brightness(1.2); }
.omr√•de6.selected { background-color: rgba(255, 140, 0, 0.85); outline: 3px solid white; }

.omr√•de7 { background-color: rgba(0, 255, 64, 0.45); border: 2px solid #00a63c; display: flex; align-items: center; justify-content: center; color: black; font-weight: bold; font-size: 0.95rem; text-shadow: 1px 1px 1px #fff; transition: transform 0.2s ease, box-shadow 0.2s ease, filter 0.2s ease; }
.omr√•de7:hover { transform: translateY(5px) scale(1.1); box-shadow: 0 0 15px rgba(0, 255, 64, 0.5); filter: brightness(1.2); }
.omr√•de7.selected { background-color: rgba(0, 255, 64, 0.85); outline: 3px solid white; }

#valgte-omr√•der-visning {
  position: absolute;
  top: 10px;
  right: 10px;
  background: rgba(0,0,0,0.6);
  color: white;
  padding: 0.5rem 1rem;
  border-radius: 8px;
  font-size: 0.9rem;
  font-weight: bold;
  z-index: 999;
  pointer-events: none;
  max-width: 200px;
  line-height: 1.6;
}

#valgte-omr√•der-visning::before {
  content: "Valgt:";
  display: block;
  margin-bottom: 0.5rem;
  font-weight: bold;
  color: #ffd;
}

#valgte-omr√•der-visning span {
  display: block;
  margin-left: 0.5rem;
  margin-bottom: 0.3rem;
  padding-left: 0.5rem;
  border-left: 3px solid #fff;
  white-space: nowrap;
}

/* HEADER MED HAB OG TITTEL */
.header-banner {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 1rem;
  margin-bottom: 2rem;
  padding-top: 1rem;
}

.hab-logo {
  height: 60px;
  object-fit: contain;
}

.header-title {
  font-size: 2rem;
  font-weight: 900;
  font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  letter-spacing: 1px;
  text-shadow: 1px 1px 2px rgba(0,0,0,0.5);
  background: linear-gradient(to right, #00b4f1, #ffffff);
  -webkit-text-fill-color: transparent;
  -webkit-background-clip: text;
  text-transform: uppercase;
}

  </style>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js"></script>







</head>
<body>

  <!-- Tynn topp-progress som fylles ved lasting/opplasting -->
<div id="top-progress"></div>

  <div id="dagens-dato-h√∏yre"></div>
  <div class="logo-header">
  <div class="header-banner">
  <img src="Hab_Transparant.png" alt="HAB Logo" class="hab-logo">
  <span class="header-title">Kongsberg Renseanlegg</span>
</div>

</div>


  <div class="container">
    <h1>üî• Daglig Sjekkliste - Varme Arbeider</h1>

    <!-- FELT FOR BRUKERNAVN -->
<section>
  <div class="input-container">
  <label for="brukerNavn">Navn:</label>
  <input type="text" id="brukerNavn" placeholder="Skriv ditt navn"
  style="width:100%; padding:10px; font-size:1rem; border-radius:8px; border:1px solid #ccc;">
</div>

  
</section>


    <!-- DEL 1: Informasjon -->
    <section>
      <h2>üìÑ Informasjon</h2>
      <p>Omr√•det er risikovurdert med lav sannsynlighet for brann, men som et forebyggende tiltak gjennomf√∏res det daglige kontroller for √• sikre at forholdene for varme arbeider fortsatt er trygge og i tr√•d med gjeldende sikkerhetskrav.</p>
    </section>

    <!-- DEL 2: Fagarbeidere -->
    <section>
      <h2>üë∑‚Äç‚ôÇÔ∏è Fagarbeidere med kurs i dag
  <span class="chip chip--ok" data-tip="Oppdatert daglig">Aktive</span>
</h2>

      <ul class="fagarbeidere" id="arbeiderListe">
        <li>Loading fagarbeidere...</li>
      </ul>
    </section>

    <!-- DEL 3: Kart/bilde -->
    <section>
      <h2>üó∫Ô∏è Velg omr√•der p√• byggeplassen
  <span id="omr√•der-badge" data-tip="Antall valgte omr√•der">0</span>
</h2>

      <div id="image-wrapper">
        <div id="valgte-omr√•der-visning">Ingen omr√•der valgt</div>

        <img src="Skjermbilde 2025-07-10 083841.png" id="byggBilde" alt="Byggeplassen">
        <div class="omr√•de omr√•de1" style="top: 16.5%; left: 29%; width: 15%; height: 11%; transform: rotate(-12deg);" onclick="toggleSelection(this)">U1-B-S3/4</div>
        <div class="omr√•de omr√•de2" style="top: 30%; left: 13%; width: 15%; height: 19%; transform: rotate(-12deg);" onclick="toggleSelection(this)">00-B-S2</div>
        <div class="omr√•de omr√•de3" style="top: 28%; left: 28%; width: 20%; height: 14%; transform: rotate(-12deg);" onclick="toggleSelection(this)">U1-B-S5</div>
        <div class="omr√•de omr√•de4" style="top: 49%; left: 17%; width: 15%; height: 12%; transform: rotate(-12deg);" onclick="toggleSelection(this)">00-B-S1</div>
        <div class="omr√•de omr√•de5" style="top: 42%; left: 32%; width: 20%; height: 12%; transform: rotate(-12deg);" onclick="toggleSelection(this)">00-D-S4</div>
        <div class="omr√•de omr√•de6" style="top: 61%; left: 21%; width: 17%; height: 8%; transform: rotate(-12deg);" onclick="toggleSelection(this)">00-D-S1</div>
        <div class="omr√•de omr√•de7" style="top:54%; left: 37%; width: 18%; height: 8%; transform: rotate(-12deg);" onclick="toggleSelection(this)">00-D-S2</div>
      </div>
    </section>

<button id="checkAll" class="btn-secondary" style="margin-bottom:10px;">‚úî Huk av alle</button>


 <section class="checklist-section">
      <h2>‚úÖ Sjekkliste f√∏r arbeid:</h2>
      <label><input type="checkbox"> √Öpninger i gulv, vegger og himlinger/tak er tettet.</label><br>
      <label><input type="checkbox"> Skjulte rom er kontrollert (trebjelkelag, ventilasjons- og avsugkanaler, nedforinger og r√∏r og lignende)..</label><br>
      <label><input type="checkbox"> Brennbare materialer/v√¶sker er fjernet.</label><br>
        <label><input type="checkbox"> Brennbart materiale som ikke kan flyttes og brennbare bygningsdeler er beskyttet eller fuktet..</label><br>
      <label><input type="checkbox"> Egnet og tilstrekkelig slokkeutstyr i forskriftsmessig stand, minimum 2 stk. 6 kg/liter h√•ndslokkeapparat skal v√¶re lett tilgjengelig.</label><br>
      <label><input type="checkbox"> Navngitt(e) brannvakt(er) er til stede under arbeidet, i pauser og n√∏dvendig tid etter at arbeidet er avsluttet, minimum en time etter at arbeidet er avsluttet.</label><br>
        <label><input type="checkbox"> Arbeidsutstyret er kontrollert og i orden.</label><br>
      <label><input type="checkbox"> Det finnes minst to r√∏mningsveier fra risikoomr√•det..</label><br>
      <label><input type="checkbox"> N√∏dnummer og prosedyrer for varsling av brann og ulykker er kjent. Arbeidsplassens adresse er kjent..</label><br>

    </section>
  
    <!-- DEL 4: Sjekkliste for brannvakt -->
<section>
  <h2>‚úÖ Oppf√∏lging etter avsluttet arbeid (Brannvakt):</h2>
  <label><input type="checkbox"> Etterkontroll slik at det ikke er fare for at brann kan oppst√•.</label><br>
  <label><input type="checkbox"> Brannalarmdetektorer eller sl√∏yfe kobles inn igjen.</label><br>
  <label><input type="checkbox"> Gassflasker plasseres n√¶rt ytterd√∏r/port for lett √• kunne bringes i sikkerhet hvis det skulle oppst√• brann.</label><br>

  <div class="upload-signature-container">
    <!-- Bildeopplasting -->
<div class="image-upload">
  <h3>üì∑ Legg til bilde av omr√•det:</h3>

  <div class="button-row">
    <!-- Kamera (tvinger kamera) -->
<label for="imageFromCamera" class="image-button">
  üì∑ Ta bilde
</label>
<input type="file" id="imageFromCamera" accept="image/*" capture="environment" style="display:none">

<label for="imageFromLibrary" class="image-button">
  üñºÔ∏è Velg fra bibliotek
</label>
<input type="file" id="imageFromLibrary" accept="image/*" style="display:none">
  </div>

  <div id="imagePreview" class="image-preview">Ingen bilder valgt</div>
</div>


    <!-- Signatur -->
    <div class="signature-box">
      <h3>‚úçÔ∏è Signatur:</h3>
      <canvas id="signature" width="300" height="100"></canvas>
    </div>
  </div>

  <!-- Knappene -->
  <div class="button-row">
    <div class="button-left">
      <button id="clearSignature" class="btn-secondary" data-tip="T√∏m signaturfeltet">T√∏m signatur</button>
    </div>
    <div class="button-right">
      <button id="lagre" class="btn-secondary" data-tip="Lagre og fortsett senere">üíæ Lagre</button>
      <button id="avslutt" class="btn-primary" data-tip="Send inn sjekklisten og avslutt">‚úÖ Avslutt og send</button>
    </div>
  </div>
</section>

  </div>

  <script src="checklist_script.js"></script>
  <script>
    
    
  </script>
  <script type="module">
  import emailjs from 'https://cdn.jsdelivr.net/npm/@emailjs/browser@3.11.0/+esm';
  window.emailjs = emailjs;
  emailjs.init("hQ1p2D6VAzYxcOEdC"); // ‚Üê bruk din egen public key
</script>


<div id="loader-overlay" style="display:none;">
  <div class="loader-container">
    <div class="loader"></div>
    <p id="loader-text">Laster opp og sender sjekklisten...</p>
    <div class="progress-bar">
      <div class="progress"></div>
    </div>
  </div>
</div>

<div id="toast-container"></div>


<div id="fullfort-screen" style="display:none; text-align:center; padding:50px;">
    <h1 style="color:#0077C8; font-size: 2.5em; font-weight: bold;">‚úÖ Sjekkliste fullf√∏rt!</h1>
    <p style="font-size:1.2em; color:#00c875;">Takk for at du gjennomf√∏rte dagens kontroll.</p>
    <p style="font-size:1em; color:#667;">Du kan n√• lukke appen.</p>
</div>

<!-- Flytende "Til toppen"-knapp -->
<button id="scrollTopBtn" aria-label="Til toppen" title="Til toppen">‚Üë</button>

<script>
  // --- Til toppen-knapp ---
  (function () {
    const btn = document.getElementById('scrollTopBtn');
    if (!btn) return;

    const toggle = () => {
      const y = window.scrollY || document.documentElement.scrollTop;
      btn.style.display = y > 250 ? 'block' : 'none';
    };
    window.addEventListener('scroll', toggle, { passive: true });
    window.addEventListener('load', toggle);
    btn.addEventListener('click', () => window.scrollTo({ top: 0, behavior: 'smooth' }));
  })();

  // --- Oppdater "omr√•der-badge" n√•r omr√•der velges ---
  (function () {
    const badge = document.getElementById('omr√•der-badge');
    const wrap = document.getElementById('image-wrapper');
    if (!badge || !wrap) return;

    const update = () => {
      const count = wrap.querySelectorAll('.omr√•de.selected').length;
      badge.textContent = count;
      badge.className = ' ' + (count ? 'chip chip--warn' : '');
    };

    // Oppdater ved klikk i kartet (uten √• overstyre din toggleSelection)
    wrap.addEventListener('click', (e) => {
      // Sm√• delay for √• la din eksisterende toggleSelection f√• sl√• inn
      setTimeout(update, 0);
    });

    // Oppdater ogs√• n√•r siden lastes
    window.addEventListener('load', update);
  })();

  // --- Topp progress-bar n√•r loader-overlay vises ---
  (function () {
    const overlay = document.getElementById('loader-overlay');
    const bar = document.getElementById('top-progress');
    if (!overlay || !bar) return;

    let rafId = null, animTimer = null;

    const start = () => {
      cancelAnimationFrame(rafId);
      clearTimeout(animTimer);
      bar.style.width = '0%';

      // Simuler progress til ~90%
      let w = 0;
      const step = () => {
        w = Math.min(90, w + 2 + Math.random() * 2);
        bar.style.width = w + '%';
        rafId = requestAnimationFrame(step);
      };
      rafId = requestAnimationFrame(step);
    };

    const finish = () => {
      cancelAnimationFrame(rafId);
      bar.style.width = '100%';
      animTimer = setTimeout(() => { bar.style.width = '0%'; }, 400);
    };

    // Observer endringer i "display" p√• overlay
    const obs = new MutationObserver(() => {
      const visible = getComputedStyle(overlay).display !== 'none';
      if (visible) start(); else finish();
    });
    obs.observe(overlay, { attributes: true, attributeFilter: ['style', 'class'] });

    // Init status
    const visible = getComputedStyle(overlay).display !== 'none';
    if (visible) start();
  })();
</script>



</body>
</html>
